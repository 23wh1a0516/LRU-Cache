<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LRU Cache Simulator</title>
    <style>
        :root {
            /* Default Theme - Ocean Blue */
            --bg-body: #f0f7ff;
            --text-primary: #2c3e50;
            --accent: #3498db;
            --accent-hover: #2980b9;
            --slot-bg: #ffffff;
            --slot-border: #3498db;
            --empty-bg: #ecf0f1;
            --new-bg: #a8e6cf;
            --evicted-bg: #ffabab;
            --hit-color: #27ae60;
            --miss-color: #e74c3c;
            --card-shadow: 0 6px 16px rgba(0,0,0,0.1);
        }

        /* Theme Variations */
        body.theme-forest {
            --bg-body: #f6fbf4;
            --text-primary: #2d5016;
            --accent: #27ae60;
            --accent-hover: #219a52;
            --slot-border: #27ae60;
            --new-bg: #d5f5e3;
            --evicted-bg: #fadbd8;
        }

        body.theme-sunset {
            --bg-body: #fff4e6;
            --text-primary: #5d4037;
            --accent: #ff9800;
            --accent-hover: #f57c00;
            --slot-border: #ff9800;
            --new-bg: #ffecb3;
            --evicted-bg: #ffcdd2;
        }

        body.theme-purple {
            --bg-body: #f5e8ff;
            --text-primary: #4a148c;
            --accent: #9c27b0;
            --accent-hover: #7b1fa2;
            --slot-border: #9c27b0;
            --new-bg: #e1bee7;
            --evicted-bg: #f8bbd0;
        }

        body.theme-dark {
            --bg-body: #1e1e1e;
            --text-primary: #e0e0e0;
            --accent: #bb86fc;
            --accent-hover: #9f6ee6;
            --slot-bg: #2d2d2d;
            --slot-border: #bb86fc;
            --empty-bg: #3a3a3a;
            --card-shadow: 0 6px 16px rgba(0,0,0,0.4);
            --hit-color: #4ade80;
            --miss-color: #ff6b6b;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: var(--bg-body);
            color: var(--text-primary);
            padding: 20px;
            max-width: 1100px;
            margin: auto;
            transition: background 0.5s ease;
            min-height: 100vh;
        }

        h1 { 
            text-align: center; 
            color: var(--accent); 
            margin: 20px 0 40px;
            font-size: 2.4em;
        }

        /* Theme Selector - Fixed Top-Right Corner */
        .theme-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--slot-bg);
            padding: 12px 16px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            border: 1px solid rgba(0,0,0,0.1);
            font-size: 15px;
            font-weight: bold;
        }

        #theme-select {
            padding: 8px 12px;
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid #ccc;
            background: var(--slot-bg);
            color: var(--text-primary);
            cursor: pointer;
            min-width: 160px;
        }

        .theme-label {
            white-space: nowrap;
            color: var(--text-primary);
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 30px 0 50px;
            align-items: end;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        label {
            font-weight: bold;
            margin-bottom: 6px;
            font-size: 15px;
        }

        input, select, button {
            padding: 12px 14px;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid #ccc;
            box-sizing: border-box;
            width: 100%;
            text-align: center;
            transition: all 0.3s;
        }

        input[type="text"] { max-width: 100%; }

        select { height: 48px; }

        button {
            background: var(--accent);
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover { background: var(--accent-hover); }

        .full-width {
            grid-column: 1 / -1;
            max-width: 300px;
            justify-self: center;
        }

        .cache {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .slot {
            min-width: 120px;
            max-width: 300px;
            width: fit-content;
            min-height: 90px;
            padding: 12px;
            background: var(--slot-bg);
            border: 2px solid var(--slot-border);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            box-shadow: var(--card-shadow);
            transition: all 0.4s ease;
            word-wrap: break-word;
            text-align: center;
            line-height: 1.4;
            overflow-wrap: anywhere;
        }

        .slot.empty { 
            background: var(--empty-bg); 
            color: #999; 
            border-style: dashed; 
            font-weight: normal;
            font-size: 15px;
            width: 120px;
            height: 90px;
        }

        .slot.new { 
            background: var(--new-bg); 
            transform: scale(1.08); 
            z-index: 10;
        }

        .slot.evicted { 
            background: var(--evicted-bg); 
            animation: fadeOut 0.8s forwards; 
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .stat-box {
            background: var(--slot-bg);
            padding: 20px 40px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            text-align: center;
            min-width: 160px;
            font-size: 18px;
            font-weight: bold;
        }

        .hit-box { border-left: 8px solid var(--hit-color); }
        .miss-box { border-left: 8px solid var(--miss-color); }

        .log {
            background: var(--slot-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            min-height: 120px;
            font-family: 'Courier New', monospace;
            overflow-y: auto;
            max-height: 300px;
            color: var(--text-primary);
            margin-bottom: 30px;
        }

        @keyframes fadeOut {
            to { opacity: 0; transform: translateY(-30px); }
        }

        .sizer {
            visibility: hidden;
            position: absolute;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 16px;
            font-weight: bold;
            padding: 12px;
            max-width: 300px;
        }
    </style>
</head>
<body class="theme-ocean">

    <h1>LRU Cache Simulator</h1>

    <!-- Theme Selector in Top-Right Corner -->
    <div class="theme-selector">
        <span class="theme-label">Theme:</span>
        <select id="theme-select">
            <option value="theme-ocean">Ocean Blue</option>
            <option value="theme-forest">Forest Green</option>
            <option value="theme-sunset">Sunset Orange</option>
            <option value="theme-purple">Purple Dream</option>
            <option value="theme-dark">Dark Mode</option>
        </select>
    </div>

    <div class="controls">
        <div class="input-group">
            <label for="capacity">Capacity</label>
            <input type="number" id="capacity" value="4" min="1" max="10">
        </div>

        <div class="input-group">
            <label for="operation">Operation</label>
            <select id="operation">
                <option value="get">Get (Access)</option>
                <option value="put">Put (Add/Update)</option>
            </select>
        </div>

        <div class="input-group">
            <label for="key">Key</label>
            <input type="text" id="key" placeholder="e.g., A or page1">
        </div>

        <div class="input-group">
            <label for="value">Value (for Put)</label>
            <input type="text" id="value" placeholder="e.g., 100 or data">
        </div>

        <button onclick="resetCache()" class="full-width">Reset Cache</button>
        <button onclick="performOperation()" class="full-width">Execute Operation</button>
    </div>

    <div class="cache" id="cache"></div>

    <div class="stats">
        <div class="stat-box hit-box">
            <div>Hits</div>
            <div id="hit-count" style="font-size: 36px; color: var(--hit-color); margin-top: 10px;">0</div>
        </div>
        <div class="stat-box miss-box">
            <div>Misses</div>
            <div id="miss-count" style="font-size: 36px; color: var(--miss-color); margin-top: 10px;">0</div>
        </div>
    </div>

    <div class="log" id="log">
        Most Recently Used ← → Least Recently Used<br><br>
        Log:
    </div>

    <div id="slot-sizer" class="sizer"></div>

    <script>
        // Theme switching - updates body class
        document.getElementById('theme-select').addEventListener('change', function() {
            document.body.className = this.value;
        });

        class LRUCache {
            constructor(capacity) {
                this.capacity = capacity;
                this.map = new Map();
            }
            get(key) {
                if (!this.map.has(key)) return -1;
                const val = this.map.get(key);
                this.map.delete(key);
                this.map.set(key, val);
                return val;
            }
            put(key, value) {
                if (this.map.has(key)) this.map.delete(key);
                this.map.set(key, value);
                if (this.map.size > this.capacity) {
                    const oldest = this.map.keys().next().value;
                    this.map.delete(oldest);
                    return oldest;
                }
                return null;
            }
            getEntries() {
                return Array.from(this.map.entries()).reverse();
            }
        }

        let cache;
        let hitCount = 0;
        let missCount = 0;
        const sizer = document.getElementById('slot-sizer');

        function updateStats() {
            document.getElementById('hit-count').textContent = hitCount;
            document.getElementById('miss-count').textContent = missCount;
        }

        function resizeInput(input) {
            if (!input.value) {
                input.style.width = '120px';
                return;
            }
            sizer.textContent = input.value || input.placeholder;
            const width = Math.min(Math.max(sizer.offsetWidth + 40, 120), 300);
            input.style.width = width + 'px';
        }

        document.getElementById('key').addEventListener('input', () => resizeInput(document.getElementById('key')));
        document.getElementById('value').addEventListener('input', () => resizeInput(document.getElementById('value')));

        function initCache() {
            const cap = parseInt(document.getElementById('capacity').value) || 4;
            cache = new LRUCache(cap);
            hitCount = 0;
            missCount = 0;
            updateStats();
            renderCache();
            logMessage('Cache initialized with capacity ' + cap);
        }

        function renderCache() {
            const container = document.getElementById('cache');
            container.innerHTML = '';
            const entries = cache.getEntries();

            for (let i = 0; i < cache.capacity; i++) {
                const slot = document.createElement('div');
                slot.className = 'slot';

                if (i < entries.length) {
                    const [k, v] = entries[i];
                    const text = `${k}:${v}`;
                    slot.textContent = text;

                    sizer.textContent = text;
                    const contentWidth = sizer.offsetWidth;
                    const contentHeight = sizer.offsetHeight;
                    slot.style.width = Math.min(contentWidth + 40, 300) + 'px';
                    slot.style.height = (contentHeight + 30) + 'px';
                } else {
                    slot.textContent = 'Empty';
                    slot.classList.add('empty');
                }
                container.appendChild(slot);
            }
        }

        function performOperation() {
            const op = document.getElementById('operation').value;
            let key = document.getElementById('key').value.trim();
            if (!key) return alert('Please enter a key');
            key = key.toUpperCase();

            const valueInput = document.getElementById('value').value.trim();

            let result, evicted;
            if (op === 'get') {
                result = cache.get(key);
                if (result === -1) {
                    missCount++;
                    logMessage(`Get(${key}) → Miss (not found)`);
                } else {
                    hitCount++;
                    logMessage(`Get(${key}) → Hit: ${result}`);
                }
                updateStats();
            } else {
                if (!valueInput) return alert('Please enter a value for Put operation');
                evicted = cache.put(key, valueInput);
                logMessage(`Put(${key}, ${valueInput})${evicted ? ' → Evicted: ' + evicted : ''}`);
            }

            animateUpdate(key, evicted);
        }

        function animateUpdate(updatedKey, evictedKey) {
            renderCache();
            const slots = document.querySelectorAll('.slot');

            slots.forEach(slot => {
                const text = slot.textContent;

                if (text.startsWith(updatedKey + ':')) {
                    slot.classList.add('new');
                    setTimeout(() => slot.classList.remove('new'), 800);
                }
                if (evictedKey && text.startsWith(evictedKey + ':')) {
                    slot.classList.add('evicted');
                }
            });
        }

        function logMessage(msg) {
            const log = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            log.innerHTML += '<br>' + timestamp + ' → ' + msg;
            log.scrollTop = log.scrollHeight;
        }

        function resetCache() {
            initCache();
            document.getElementById('log').innerHTML = 'Most Recently Used ← → Least Recently Used<br><br>Log:';
            document.getElementById('key').value = '';
            document.getElementById('value').value = '';
            document.getElementById('key').style.width = '120px';
            document.getElementById('value').style.width = '120px';
        }

        // Initialize
        initCache();
        resizeInput(document.getElementById('key'));
        resizeInput(document.getElementById('value'));
    </script>
</body>
</html>